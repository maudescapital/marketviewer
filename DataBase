package pkg14152015database;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.Date;

public class DataBase {
  private Connection connect = null;
  private Statement statement = null;
  private PreparedStatement preparedStatement = null;
  private PreparedStatement preparedStatementt = null;
  private ResultSet resultSet = null;
      
public void selectall() throws SQLException, ClassNotFoundException {
        try {             
            Class.forName("com.mysql.jdbc.Driver");
            connect = DriverManager.getConnection("jdbc:mysql://localhost/14112015IB?"
              + "user=root&password=clave");
            System.out.println("Connection Succesful");
        } catch (SQLException ex) {
            System.out.println("SQL error");
        
        } catch (Exception ex) {
            System.out.println("Connection error");
        }
    }  
  
  public void writsomething (int stockId, int obs, String symbol, int date, String time, double price, int size,String bidorask) throws SQLException, ClassNotFoundException{
      // This will load the MySQL driver, each DB has its own driver
      Class.forName("com.mysql.jdbc.Driver");
      // Setup the connection with the DB
      connect = DriverManager.getConnection("jdbc:mysql://localhost/14112015IB?"
              + "user=root&password=clave");
      // PreparedStatements can use variables and are more efficient
      preparedStatement = connect
          .prepareStatement("insert into Bid values (?,?, ?, ?, ?, ?, ?,?)");
      // "myuser, webpage, datum, summery, COMMENTS from feedback.comments");
      // Parameters start with 1
      preparedStatement.setInt(1,stockId);
      preparedStatement.setInt(2,obs);
      preparedStatement.setString(3,symbol);
      preparedStatement.setInt(4, date);
      preparedStatement.setString(5,time);
      preparedStatement.setDouble(6,price);
      preparedStatement.setInt(7,size);
      preparedStatement.setString(8,bidorask);
  
      preparedStatement.executeUpdate();
      
     preparedStatementt = connect
               .prepareStatement("update BIDASK set " + bidorask +"=" + price);
     preparedStatementt.executeUpdate();
  }
      
  }
