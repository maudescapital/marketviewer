package pkg14152015database;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.Date;

public class DataBaseDina {
  private Connection connect = null;
  private Statement statement = null;
  private PreparedStatement preparedStatement = null;
  private ResultSet resultSet = null;
  double bidprice;
  double askprice;
  double trades;
  String Stringsymbol;
  String Stringbidprice;
  String Stringaskprice; 
  String Stringtrades; 
  
public void selectmarket() throws SQLException, ClassNotFoundException {   
    try {             
            Class.forName("com.mysql.jdbc.Driver");
            connect = DriverManager.getConnection("jdbc:mysql://localhost/14112015IB?"
              + "user=root&password=clave");
            Statement stat = connect.createStatement(); // Prepara el entorno de trabajo
            //ResultSet no es más que una clase java similar a una lista en la que está el resultado de la consulta
            ResultSet rs = stat.executeQuery("select * from BIDASK");//executeQuery para su uso con SELECT
           // Es una megavariable donde yo voy a crear unos registros. Como si en la memoria se nos guardase la tabla con filas y columnas
            while (rs.next()) {
            Stringsymbol = rs.getString("STOCKID");    
            bidprice = rs.getDouble("BID");
            askprice = rs.getDouble("ASK");
            trades = rs.getDouble("TRADES"); 
            }
            
            //Convertimos a String para mostrarlos en el frame
            Stringbidprice = String.valueOf(bidprice);
            Stringaskprice = String.valueOf(askprice);
            Stringtrades = String.valueOf(trades);       
            
            stat.close();// primero el stat y luego conn, en ese orden.
            connect.close();//Cerramos la conexion
            
        } catch (SQLException ex) {
            System.out.println("SQL error");
        
        } catch (Exception ex) {
            System.out.println("Connection error");
        }
}   
  }

